# 项目目录结构

在这个文件架构基础上，我们可以根据各模块的功能进一步定义文件内容和职责，以确保模块划分合理，代码清晰且易于维护。以下是对每个模块的详细说明和修改建议：

---

## **修改后的项目目录结构**

```bash
project/
├── main.py               # 主程序入口
├── parsers/              # 解析相关模块
│   ├── eml_parser.py     # EML 文件解析模块
│   ├── body_parser.py    # 提取正文的辅助模块
│   └── attachment.py     # 附件处理模块
├── database/             # 数据库相关模块
│   ├── db_init.py        # 数据库初始化模块
│   └── db_operations.py  # 数据库操作模块
├── utils/                # 工具模块
│   ├── config.py         # 配置管理模块
│   └── logger.py         # 日志记录模块
├── attachments/          # 存放附件
├── logs/                 # 日志文件
│   └── app.log           # 日志文件
├── config.json           # 配置文件
├── .env                  # 环境变量配置
├── database.db           # SQLite数据库文件
├── requirements.txt      # 依赖库
├── README.md             # 项目说明文档
└── tests/                # 测试模块
    ├── test_emails.py    # 邮件功能测试
    ├── test_parsers.py   # 解析功能测试
    └── test_utils.py     # 工具模块测试
```

---

## **模块职责说明**

### **1. `main.py`**  

- **职责**：程序入口，调用各模块完成主流程。
- **内容**：
  - 解析命令行参数（如EML文件路径）。
  - 加载配置文件。
  - 调用解析模块解析EML文件。
  - 调用数据库模块保存数据。
  - 记录流程日志。

---

### **2. `parsers/`**

#### **`eml_parser.py`**

- **职责**：主解析模块，负责从EML文件中提取数据。
- **功能**：
  - 使用`email`库解析EML文件。
  - 调用`body_parser.py`提取正文。
  - 调用`attachment.py`处理附件。
- **输出**：
  - 一个包含邮件元信息、正文和附件信息的字典。

#### **`body_parser.py`**

- **职责**：提取邮件正文（包括多部分的HTML或纯文本内容）。
- **功能**：
  - 从`email.message`对象中提取纯文本或HTML正文。
  - 处理编码和多部分内容。

#### **`attachment.py`**

- **职责**：处理附件提取和保存。
- **功能**：
  - 提取附件文件。
  - 保存到`attachments/`目录。
  - 返回附件的元信息（文件名、路径等）。

---

### **3. `database/`**

#### **`db_init.py`**

- **职责**：初始化SQLite数据库。
- **功能**：
  - 创建数据库文件（如果不存在）。
  - 初始化表结构。

#### **`db_operations.py`**

- **职责**：提供数据库的增删改查操作。
- **功能**：
  - 插入邮件数据（元信息、正文、附件路径）。
  - 查询或更新数据库记录。

---

### **4. `utils/`**

#### **`config.py`**

- **职责**：加载和管理配置。
- **功能**：
  - 从`config.json`读取配置。
  - 提供默认配置并允许用户自定义。

#### **`logger.py`**

- **职责**：封装日志功能。
- **功能**：
  - 初始化日志配置（文件路径、日志格式、日志级别）。
  - 提供日志记录接口。

---

### **5. 其他目录和文件**

#### **`attachments/`**

- **职责**：存储从EML文件中提取的附件。

#### **`logs/`**

- **职责**：存储运行日志文件。

#### **`config.json`**

- **职责**：存储程序配置，包括：
  - 数据库路径。
  - 附件存储目录。
  - 日志文件路径。

#### **`requirements.txt`**

- **职责**：列出项目依赖库，例如：

  ```text
  email
  sqlite3
  logging
  json
  ```

---

这套架构既保持了简洁性，又遵循模块化设计原则，便于开发、测试和扩展。
